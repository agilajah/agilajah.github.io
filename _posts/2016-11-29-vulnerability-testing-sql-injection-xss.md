---
layout: post
title: Sragen Government Website vulnerability testing using SQL Injection and XSS
description: ""
tags: [SQL Injection, XSS]

---

SQL Injections are one of the most common forms of attack : https://www.owasp.org/index.php/Top_10_2013-A1. SQL Injection attacks account for almost 1/3 of all attacks on Web Applications.  As per OWASP, an injection vulnerability or flaw is one that encompasses SQL, OS, and LDAP where untrusted data is sent to an interpreter through a command or query that goes unsanitized by the web application. The interpreter will then execute the code as though it was part of the developer's original code. 

Injection vulnerabilities can be extremely dangerous. This may lead to attackers gaining Admin Privileges on your Database so the attackers could retrieve, insert, and even delete information. 

Another vulnerability that is listed in the top three of the OWASP is on the client-side: XSS (Cross-site Scripting) attack in which the attacker can execute malicious scripts into a web application. Instead of an attacker injecting code to cause harm on the server-side, the code is instead used to cause harm on the user side. We could simply put it as insertion of malicious Javascript code in a webpage, that can redirect page to phishing sites or fake login pages, steal your session cookie, and even worms.

The first step to performing an SQL injection attack is to find a vulnerable website. One of the easiest ways to find vulnerable sites is known as Google Dorking. For instance, "?search=" or ".php?q=" "inurl:pageid=" and "inurl:article.php?id=" . 

SQL injection can work on any SQL database, but PHP-based websites are usually the best targets because they can be set up by just about anyone(i.e Wordpress).

In this article we will testing the vulnerability of Sragen City Government website (http://sragenkab.go.id/berita.php?id=xx), where xx is news id.

We could inject the website by appending "or" statement. An "or" statement in this URL would look like this :

{% highlight html linenos %}
http://sragenkab.go.id/berita.php?id=250 or 1=1
{% endhighlight %}

The results of this query will allows us to see all of the news item (not only news with id = 250).

Now, let's try another vulnerability attack. We will leverage XSS and using JavaScript since it is fundamental to most browsing experiences. 

In order for an XSS attack to take place the vulnerable website needs to directly include user input in its pages. The input is usually in the form of javascript, that can be stored by the application and returned to other users when they visit the page. Thereby executing the javascript in the users browsers.

We could also testing XSS Scripting by injecting script through URL like this:

{% highlight html linenos %}
http://sragenkab.go.id/berita.php?id="250 <h1> Ini script injeksi </h1>"
{% endhighlight %}

For both cases (XSS and SQL injection), we succedeed in testing the website vulnerability. Click this link for complete report and details (with images).

There is definitely more to each of these exploit types, but I hope this general overview has given you a clearer understanding of the consequences and differences between those attacks.


###  Is your website or web applciation vulnerable to SQL Injection or Cross-site Scripting?

Well, lets take a look at these link for a minute if you want to know: 
* `https://www.owasp.org/index.php/Top_10_2013-A1`
* `https://paragonie.com/blog/2015/06/preventing-xss-vulnerabilities-in-php-everything-you-need-know`

